version: '3.8'
services:
  heygem-helper:
    build:
      context: ./server
      dockerfile: Dockerfile
    image: heygem-helper:latest
    container_name: heygem-helper
    environment:
      - APP_PORT=8090
      - STATIC_DIR=/app/client-dist
      - DIGITAL_PEOPLE_DIR=/root/windows-share
      - APP_WORKDIR=/root/windows-share/workdir
      - HOST_VOICE_DIR=/root/windows-share/voice/data
      - HOST_VIDEO_DIR=/root/windows-share/face2face
      - HOST_RESULT_DIR=/root/windows-share/face2face/result
      - WIN_COMPANY_DIR=/root/windows-share
      - TTS_BASE_URL=http://host.docker.internal:18180
      - VIDEO_BASE_URL=http://host.docker.internal:8383
      - GEN_VIDEO_CONTAINER=heygem-gen-video
      - GEN_VIDEO_CONTAINER_DATA_ROOT=/code/data
    volumes:
      - ${DIGITAL_PEOPLE_DIR:-/root/heygem_data/digitalpeople}:/root/windows-share
      - /var/run/docker.sock:/var/run/docker.sock
      - ./client/dist:/app/client-dist:ro
    ports:
      - "8090:8090"
